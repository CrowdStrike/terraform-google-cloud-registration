# =============================================================================
# CrowdStrike GCP CSPM Terraform Module Configuration Example
# =============================================================================

# REQUIRED: CrowdStrike API Credentials
falcon_client_id     = "YOUR_CLIENT_ID_HERE"
falcon_client_secret = "YOUR_CLIENT_SECRET_HERE"

# REQUIRED: GCP Project for CrowdStrike Infrastructure
# Project where WIF pools, pub/sub topics, etc. will be created
infra_project_id = "your-cspm-infrastructure-project"

# REQUIRED: AWS Account ID for CrowdStrike's Identity
aws_account_id = "532730071073"  # CrowdStrike's AWS account

# REQUIRED: AWS Role ARN for Identity Federation
# Format: arn:aws:sts::ACCOUNT_ID:assumed-role/ROLE_NAME
role_arn = "arn:aws:sts::532730071073:assumed-role/CrowdStrikeCSPMConnector-Dev"

# =============================================================================
# ENVIRONMENT CONFIGURATION
# =============================================================================

# DODO Red Environment
# falcon_cloud_api_host = "https://cscloudregistration-s001-main.red.dodo.eyrie.cloud"
# customer_id = "YOUR_DODO_CUSTOMER_ID"

# DODO Black Environment
# falcon_cloud_api_host = "https://cscloudregistration-s001-main.black.dodo.eyrie.cloud"
# customer_id = "YOUR_DODO_CUSTOMER_ID"

# Production US Environment
# falcon_cloud_api_host = "https://api.crowdstrike.com"

# Production EU Environment
# falcon_cloud_api_host = "https://api.eu-1.crowdstrike.com"

# =============================================================================
# REGISTRATION SCOPE - Choose ONE of the following three options
# =============================================================================

# OPTION 1: Project-level Registration
registration_type = "project"
project_ids       = ["project-1", "project-2", "project-3"]  # List of project IDs

# OPTION 2: Folder-level Registration
# registration_type = "folder"
# folder_ids        = ["123456789012", "234567890123"]  # List of folder IDs

# OPTION 3: Organization-level Registration
# registration_type = "organization"
# organization_id   = "123456789012"  # Your GCP Organization ID

# =============================================================================
# OPTIONAL: Real Time Visibility & Detection (RTV&D)
# =============================================================================

# Enable log ingestion for real-time threat detection
enable_realtime_visibility = false

# Log ingestion configuration (only used if enable_realtime_visibility = true)
log_ingestion_settings = {
  message_retention_duration       = "1209600s"  # 14 days in seconds
  ack_deadline_seconds             = 300         # 5 minutes
  topic_message_retention_duration = "2592000s"  # 30 days in seconds
  audit_log_types                  = ["activity", "system_event", "policy"]
  enable_schema_validation         = false
  schema_type                      = "AVRO"
  
  # Optional: Exclude specific logs based on labels
  exclusion_filters = [
    "resource.labels.environment=\"test\"",
    "resource.labels.temporary=\"true\""
  ]
}

# =============================================================================
# OPTIONAL: Resource Naming and Organization
# =============================================================================

# Prefix and suffix for resource names
# resource_prefix = "cs"
# resource_suffix = "prod"

# Labels applied to all created resources
labels = {
  environment = "production"
  owner       = "security-team"
  project     = "cspm"
  managed-by  = "terraform"
}